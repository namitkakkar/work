define(["require","exports","../ampCommon/tasklist/Task","knockout","ojs/ojarraydataprovider","ojs/ojknockouttemplateutils","ojs/ojmodule-element-utils","../viewModels/CostApproach","ojs/ojtable","ojs/ojselectcombobox","ojs/ojdialog","ojs/ojselectsingle"],(function(require,t,e,i,o,a,l,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function t(){var t=this;this.group=i.observable(),this.activity=i.observable(),this.routingInsId=i.observable(),this.addActivity=function(e){var i=t,o={ACTIVITY:i.activity(),STAGE:"Appraisal",WU_ROUTING_INST_ID:i.routingInsId(),WU_INST_AO_ID:i.task().workUnitDetailsList()[0].WU_AO[0].WU_INST_AO_ID,UI_RESOURCE_ID:"CostApproach",ACTIVITY_PAYLOAD:null,ACTIVITY_PAYLOAD_STR:null,ROW_ID:i.task().workUnitDetailsList()[0].WU_AO[0].WU_ACTIVITIES.length+1};i.task().workUnitDetailsList()[0].WU_AO[0].WU_ACTIVITIES.push(o),i.task().filterActivities("Appraisal"),document.getElementById("addActivityDialog").close()},this.editAdvanceActivity=function(e,i){var o=t,a=e||i;console.log("edit identifier::",a),console.log("actId::",e," rowId::",i),console.log("activity::",o.task().workUnitDetailsList()[0].WU_AO[0]);o.selectedActivity=o.task().workUnitDetailsList()[0].WU_AO[0].WU_ACTIVITIES.filter((function(t){return(t.ACTIVITY_INST_ID?t.ACTIVITY_INST_ID:t.ROW_ID)===a}))[0],console.log("selected act::",o.selectedActivity),o.selectedActivity.UI_RESOURCE_ID;if(Promise.all([l.createView({viewPath:"views/CostApproach.html"}),l.createViewModel({viewModelPath:"viewModels/CostApproach"})]).then((function(e){t.advActivityModuleConfig({view:e[0],viewModel:e[1].default})})),console.log("payload::",o.selectedActivity.ACTIVITY_PAYLOAD),void 0!==o.selectedActivity){var s=JSON.parse(o.selectedActivity.ACTIVITY_PAYLOAD_STR);o.selectedActivity.ACTIVITY_STR_PAYLOAD=s,o.loadCostApproachPayload(o.selectedActivity.ACTIVITY_STR_PAYLOAD),console.log("object::",o.selectedActivity.ACTIVITY_STR_PAYLOAD)}else document.getElementById("editAdvActivityDialog").open()},this.loadCostApproachPayload=function(t){s.default.loadCostApproachDetails(t),document.getElementById("editAdvActivityDialog").open()},this.prepareCostApproachPayload=function(){var e,i=t;e=s.default.prepareCostApproachPayload(),console.log("activity payload::",e),i.selectedActivity.ACTIVITY_PAYLOAD=e,delete i.selectedActivity.ACTIVITY_STR_PAYLOAD,delete i.selectedActivity.ACTIVITY_PAYLOAD_STR,void 0!==i.selectedActivity.GCM_ACTIVITY_ID?(i.selectedActivity.OPERATION_FLAG="U",i.selectedActivity.ROW_ID=null==i.selectedActivity.ROW_ID?0:i.selectedActivity.ROW_ID):i.selectedActivity.OPERATION_FLAG="I",console.log("opr flag::",i.selectedActivity.OPERATION_FLAG),console.log("act id::",i.selectedActivity.GCM_ACTIVITY_ID);var a={WU_DETAILS:[{WU_INST_ID:i.task().workUnitDetailsList()[0].WU_INST_ID,WU_NUMBER:i.task().workUnitDetailsList()[0].WU_NUMBER,WU_AO:[{WU_ACTIVITIES:[i.selectedActivity],PROPERTY_TYPE:i.task().workUnitDetailsList()[0].WU_AO[0].PROPERTY_TYPE,WU_INST_ID:i.task().workUnitDetailsList()[0].WU_INST_ID,WU_INST_AO_ID:i.task().workUnitDetailsList()[0].WU_AO[0].WU_INST_AO_ID,ASMT_OBJ_ID:i.task().workUnitDetailsList()[0].WU_AO[0].ASMT_OBJ_ID,AIN:i.task().workUnitDetailsList()[0].WU_AO[0].AIN}],BUSINESS_EVENT_DATE:i.task().workUnitDetailsList()[0].BUSINESS_EVENT_DATE}]};console.log("payload::",JSON.stringify(a)),i.task().saveWUActivityPayload(a,(function(t){console.log(t),i.task().workUnitDetailsList(t.WU_DETAILS),i.task().filterActivities("Appraisal"),console.log("activity stage array::",i.task().activityStageArray()),i.activityDataProvider(new o(i.task().activityStageArray(),{idAttribute:""}))}),(function(t){return console.log(t)})),console.log("Activity Payload::",i.selectedActivity),document.getElementById("editAdvActivityDialog").close()},this.closeAdvActivity=function(t){document.getElementById("editAdvActivityDialog").close()};var c=this;c.task=i.observable(e.Task.getInstance()),c.activityDataProvider=i.observable(),c.activityColumnArray=i.observableArray([{headerText:"",field:"",renderer:a.getRenderer("activity_erase",!0)},{headerText:"",field:"",renderer:a.getRenderer("activity_edit",!0)},{headerText:"Activity",field:"ACTIVITY",renderer:a.getRenderer("activity_name",!0)},{headerText:"Comments",field:"",renderer:a.getRenderer("activity_comment",!0)},{headerText:"Date Completed",field:"",renderer:a.getRenderer("activity_datecompleted",!0)},{headerText:"Duration",field:"",renderer:a.getRenderer("activity_duration",!0)},{headerText:"Overtime",field:"",renderer:a.getRenderer("activity_overtime",!0)},{headerText:"Completed",field:""}]),c.groupDP=i.observable(),c.activityDP=i.observable();c.groupDP(new o([{value:"Cost Approach",label:"Cost Approach"}],{idAttribute:"value"})),c.activityDP(new o([{value:"Cost Approach - Outcome",label:"Cost Approach - Outcome"}],{idAttribute:"value"})),i.computed((function(){c.activityDataProvider(new o(c.task().activityStageArray(),{idAttribute:""})),void 0!==c.task().task()&&c.task().task().payload.GCMWorkTask.EventParameterList.EventParameter.forEach((function(t){null!=t.Name&&"WURoutingInstanceID"==t.Name&&void 0!==t.Value&&c.routingInsId(t.Value)}))})),c.advActivityModuleConfig=i.observable({view:[],viewModel:null})}return t.prototype.openActivity=function(t){document.getElementById("addActivityDialog").open()},t.prototype.close=function(t){document.getElementById("addActivityDialog").close()},t.prototype.connected=function(){},t}();t.default=c}));